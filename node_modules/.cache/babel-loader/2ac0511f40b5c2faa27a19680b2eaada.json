{"ast":null,"code":"import _objectSpread from \"C:\\\\pr0\\\\blockchain-developer-bootcamp\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";\nimport { get, groupBy, reject } from 'lodash';\nimport { createSelector } from 'reselect';\nimport moment from 'moment';\nimport { ETHER_ADDRESS, GREEN, RED, tokens, ether } from '../helpers';\n\nvar account = function account(state) {\n  return get(state, 'web3.account');\n};\n\nexport var accountSelector = createSelector(account, function (a) {\n  return a;\n});\n\nvar tokenLoaded = function tokenLoaded(state) {\n  return get(state, 'token.loaded', false);\n};\n\nexport var tokenLoadedSelector = createSelector(tokenLoaded, function (tl) {\n  return tl;\n});\n\nvar exchangeLoaded = function exchangeLoaded(state) {\n  return get(state, 'exchange.loaded', false);\n};\n\nexport var exchangeLoadedSelector = createSelector(exchangeLoaded, function (el) {\n  return el;\n});\n\nvar exchange = function exchange(state) {\n  return get(state, 'exchange.contract');\n};\n\nexport var exchangeSelector = createSelector(exchange, function (e) {\n  return e;\n});\nexport var contractsLoadedSelector = createSelector(tokenLoaded, exchangeLoaded, function (tl, el) {\n  return tl && el;\n}); //All Orders\n\nvar allOrdersLoaded = function allOrdersLoaded(state) {\n  return get(state, 'exchange.allOrders.loaded', false);\n};\n\nvar allOrders = function allOrders(state) {\n  return get(state, 'exchange.allOrders.data', []);\n}; // Cancelled Orders\n\n\nvar cancelledOrdersLoaded = function cancelledOrdersLoaded(state) {\n  return get(state, 'exchange.cancelledOrders.loaded', false);\n};\n\nexport var cancelledOrdersLoadedSelector = createSelector(cancelledOrdersLoaded, function (loaded) {\n  return loaded;\n});\n\nvar cancelledOrders = function cancelledOrders(state) {\n  return get(state, 'exchange.cancelledOrders.data', []);\n};\n\nexport var cancelledOrdersSelector = createSelector(cancelledOrders, function (o) {\n  return o;\n}); // Filled Orders\n\nvar filledOrdersLoaded = function filledOrdersLoaded(state) {\n  return get(state, 'exchange.filledOrders.loaded', false);\n};\n\nexport var filledOrdersLoadedSelector = createSelector(filledOrdersLoaded, function (loaded) {\n  return loaded;\n});\n\nvar filledOrders = function filledOrders(state) {\n  return get(state, 'exchange.filledOrders.data', []);\n};\n\nexport var filledOrdersSelector = createSelector(filledOrders, function (orders) {\n  // console.log(orders)\n  // Sort orders by date ascending for price comparison\n  orders = orders.sort(function (a, b) {\n    return a.timestamp - b.timestamp;\n  }); // console.log('ORDERS Timestamped', orders)\n  // Decorate the orders\n\n  orders = decorateFilledOrders(orders); // console.log('ORDERS Decorated', orders)\n  // Sort orders by date descending for display\n\n  orders = orders.sort(function (a, b) {\n    return b.timestamp - a.timestamp;\n  });\n  return orders;\n});\n\nvar decorateFilledOrders = function decorateFilledOrders(orders) {\n  // Track previous to compare history\n  var previousOrder = orders[0];\n  return orders.map(function (order) {\n    order = decorateOrder(order);\n    order = decorateFilledOrder(order, previousOrder);\n    previousOrder = order; // Update the previous order once it's decorated\n\n    return order;\n  });\n};\n\nvar decorateOrder = function decorateOrder(order) {\n  var etherAmount;\n  var tokenAmount; // if tokenGive \n\n  if (order.tokenGive === ETHER_ADDRESS) {\n    etherAmount = order.amountGive;\n    tokenAmount = order.amountGet;\n  } else {\n    etherAmount = order.amountGet;\n    tokenAmount = order.amountGive;\n  } // Calculate token price to 5 decimal places\n\n\n  var precision = 100000;\n  var tokenPrice = etherAmount / tokenAmount;\n  tokenPrice = Math.round(tokenPrice * precision) / precision; // console.log(order)\n\n  return _objectSpread(_objectSpread({}, order), {}, {\n    etherAmount: ether(etherAmount),\n    tokenAmount: tokens(tokenAmount),\n    tokenPrice: tokenPrice,\n    formattedTimestamp: moment.unix(order.timestamp).format('h:mm:ss a M/D')\n  });\n};\n\nvar decorateFilledOrder = function decorateFilledOrder(order, previousOrder) {\n  return _objectSpread(_objectSpread({}, order), {}, {\n    tokenPriceClass: tokenPriceClass(order.tokenPrice, order.id, previousOrder)\n  });\n};\n\nvar tokenPriceClass = function tokenPriceClass(tokenPrice, orderId, previousOrder) {\n  // Show green price if only one order exists\n  if (previousOrder.id === orderId) {\n    return GREEN;\n  } // Show green price if order price higher than previous price\n  // Show red price if order price lower than previous order\n\n\n  if (previousOrder.tokenPrice <= tokenPrice) {\n    return GREEN; // success\n  } else {\n    return RED; // danger\n  }\n};\n\nvar openOrders = function openOrders(state) {\n  var all = allOrders(state);\n  var filled = filledOrders(state);\n  var cancelled = cancelledOrders(state);\n  var openOrders = reject(all, function (order) {\n    //lodash - reject\n    var orderFilled = filled.some(function (o) {\n      return o.id === order.id;\n    });\n    var orderCancelled = cancelled.some(function (o) {\n      return o.id === order.id;\n    });\n    return orderFilled || orderCancelled;\n  });\n  return openOrders;\n}; // Order Book \n\n\nvar orderBookLoaded = function orderBookLoaded(state) {\n  return cancelledOrdersLoaded(state) && filledOrdersLoaded(state) && allOrdersLoaded(state);\n};\n\nexport var orderBookLoadedSelector = createSelector(orderBookLoaded, function (loaded) {\n  return loaded;\n}); //Create the Order Book\n\nexport var orderBookSelector = createSelector(openOrders, function (orders) {\n  // Decorate orders\n  orders = decorateOrderBookOrders(orders); // Group orders by \"orderType\"\n\n  orders = groupBy(orders, 'orderType'); // Fetch Buy orders\n\n  var buyOrders = get(orders, 'buy', []); // Sort Buy orders by token price\n\n  orders = _objectSpread(_objectSpread({}, orders), {}, {\n    buyOrders: buyOrders.sort(function (a, b) {\n      return b.tokenPrice - a.tokenPrice;\n    })\n  }); // Fetch Sell orders\n\n  var sellOrders = get(orders, 'sell', []); // Sort Sell orders by token price\n\n  orders = _objectSpread(_objectSpread({}, orders), {}, {\n    sellOrders: sellOrders.sort(function (a, b) {\n      return b.tokenPrice - a.tokenPrice;\n    })\n  });\n  return orders;\n});\n\nvar decorateOrderBookOrders = function decorateOrderBookOrders(orders) {\n  return orders.map(function (order) {\n    order = decorateOrder(order);\n    order = decorateOrderBookOrder(order); // Decorate Order book order\n\n    return order;\n  });\n};\n\nvar decorateOrderBookOrder = function decorateOrderBookOrder(order) {\n  var orderType = order.tokenGive === ETHER_ADDRESS ? 'buy' : 'sell';\n  return _objectSpread(_objectSpread({}, order), {}, {\n    orderType: orderType,\n    orderTypeClass: orderType === 'buy' ? GREEN : RED,\n    orderFillClass: orderType === 'buy' ? 'sell' : 'buy'\n  });\n}; // My Transactions \n\n\nexport var myFilledOrdersLoadedSelector = createSelector(filledOrdersLoaded, function (loaded) {\n  return loaded;\n});\nexport var myFilledOrdersSelector = createSelector(account, filledOrders, function (account, orders) {\n  // Find our orders\n  orders = orders.filter(function (o) {\n    return o.user === account || o.userFill === account;\n  }); // Sort by date descending\n\n  orders = orders.sort(function (a, b) {\n    return a.timestamp - b.timestamp;\n  }); //Decorate orders - add display attributes\n\n  orders = decorateMyFilledOrders(orders, account);\n  return orders;\n});\n\nvar decorateMyFilledOrders = function decorateMyFilledOrders(orders, account) {\n  return orders.map(function (order) {\n    order = decorateOrder(order);\n    order = decorateMyFilledOrder(order, account);\n    return order;\n  });\n};\n\nvar decorateMyFilledOrder = function decorateMyFilledOrder(order, account) {\n  var myOrder = order.user === account;\n  var orderType;\n\n  if (myOrder) {\n    orderType = order.tokenGive === ETHER_ADDRESS ? 'buy' : 'sell';\n  } else {\n    orderType = order.tokenGive === ETHER_ADDRESS ? 'sell' : 'buy';\n  }\n\n  return _objectSpread(_objectSpread({}, order), {}, {\n    orderType: orderType,\n    orderTypeClass: orderType === 'buy' ? GREEN : RED,\n    orderSign: orderType === 'buy' ? '+' : '-'\n  });\n};\n\nexport var myOpenOrdersLoadedSelector = createSelector(orderBookLoaded, function (loaded) {\n  return loaded;\n});\nexport var myOpenOrdersSelector = createSelector(account, openOrders, function (account, orders) {\n  // console.log('ORDERS', orders)\n  // Filter orders create by current account\n  orders = orders.filter(function (o) {\n    return o.user === account;\n  }); // console.log('ORDERS', orders)\n  // Decorate orders - add display attributes\n\n  orders = decorateMyOpenOrders(orders); // console.log('ORDERS', orders)\n  //Sort orders by date descending\n\n  orders = orders.sort(function (a, b) {\n    return b.timestamp - a.timestamp;\n  }); // console.log('ORDERS', orders)\n\n  return orders;\n});\n\nvar decorateMyOpenOrders = function decorateMyOpenOrders(orders, account) {\n  return orders.map(function (order) {\n    order = decorateOrder(order);\n    order = decorateMyOpenOrder(order, account);\n    return order;\n  });\n};\n\nvar decorateMyOpenOrder = function decorateMyOpenOrder(order, account) {\n  var orderType = order.tokenGive === ETHER_ADDRESS ? 'buy' : 'sell';\n  return _objectSpread(_objectSpread({}, order), {}, {\n    orderType: orderType,\n    orderTypeClass: orderType === 'buy' ? GREEN : RED\n  });\n};\n\nexport var priceChartLoadedSelector = createSelector(filledOrdersLoaded, function (loaded) {\n  return loaded;\n});\nexport var priceChartSelector = createSelector(filledOrders, function (orders) {\n  // Sort orders by data ascending to compare history\n  orders = orders.sort(function (a, b) {\n    return b.timestamp - a.timestamp;\n  });\n  orders = orders.map(function (o) {\n    return decorateOrder(o);\n  });\n  return {\n    series: [{\n      data: buildGraphData(orders)\n    }]\n  };\n});\n\nvar buildGraphData = function buildGraphData(orders) {\n  // Group the orders by hour for the graph\n  orders = groupBy(orders, function (o) {\n    return moment.unix(o.timestamp).startOf('hour').format();\n  }); // Get each hour where data exists\n\n  var hours = Object.keys(orders); //Build the graph series\n\n  var graphData = hours.map(function (hour) {\n    // Fetch all the orders from current hour\n    var group = orders[hour]; // Calculate price values - open, high, low, close\n\n    var open = group[0]; //first order\n\n    var high = maxBy(group, 'tokenPrice'); // use lodash maxBy for high price\n\n    var low = minBy(group, 'tokenPrice'); // low price (lodash minBy)\n\n    var close = group[group.length - 1]; // last order\n\n    return {\n      x: new Date(hour),\n      y: [open.tokenPrice, high.tokenPrice, low.tokenPrice, close.tokenPrice]\n    };\n  });\n  return graphData;\n};","map":{"version":3,"names":["get","groupBy","reject","createSelector","moment","ETHER_ADDRESS","GREEN","RED","tokens","ether","account","state","accountSelector","a","tokenLoaded","tokenLoadedSelector","tl","exchangeLoaded","exchangeLoadedSelector","el","exchange","exchangeSelector","e","contractsLoadedSelector","allOrdersLoaded","allOrders","cancelledOrdersLoaded","cancelledOrdersLoadedSelector","loaded","cancelledOrders","cancelledOrdersSelector","o","filledOrdersLoaded","filledOrdersLoadedSelector","filledOrders","filledOrdersSelector","orders","sort","b","timestamp","decorateFilledOrders","previousOrder","map","order","decorateOrder","decorateFilledOrder","etherAmount","tokenAmount","tokenGive","amountGive","amountGet","precision","tokenPrice","Math","round","formattedTimestamp","unix","format","tokenPriceClass","id","orderId","openOrders","all","filled","cancelled","orderFilled","some","orderCancelled","orderBookLoaded","orderBookLoadedSelector","orderBookSelector","decorateOrderBookOrders","buyOrders","sellOrders","decorateOrderBookOrder","orderType","orderTypeClass","orderFillClass","myFilledOrdersLoadedSelector","myFilledOrdersSelector","filter","user","userFill","decorateMyFilledOrders","decorateMyFilledOrder","myOrder","orderSign","myOpenOrdersLoadedSelector","myOpenOrdersSelector","decorateMyOpenOrders","decorateMyOpenOrder","priceChartLoadedSelector","priceChartSelector","series","data","buildGraphData","startOf","hours","Object","keys","graphData","hour","group","open","high","maxBy","low","minBy","close","length","x","Date","y"],"sources":["C:/pr0/blockchain-developer-bootcamp/src/store/selectors.js"],"sourcesContent":["import { get, groupBy, reject } from 'lodash'\r\nimport { createSelector } from 'reselect'\r\nimport moment from 'moment'\r\nimport { ETHER_ADDRESS, GREEN, RED, tokens, ether  } from '../helpers'\r\n\r\nconst account = state => get(state, 'web3.account')\r\nexport const accountSelector = createSelector(account, a => a)\r\n\r\nconst tokenLoaded = state => get(state, 'token.loaded', false)\r\nexport const tokenLoadedSelector = createSelector(tokenLoaded, tl => tl)\r\n\r\nconst exchangeLoaded = state => get(state, 'exchange.loaded', false)\r\nexport const exchangeLoadedSelector = createSelector(exchangeLoaded, el => el)\r\n\r\nconst exchange = state => get(state, 'exchange.contract')\r\nexport const exchangeSelector = createSelector(exchange, e => e)\r\n\r\nexport const contractsLoadedSelector = createSelector(\r\n    tokenLoaded,\r\n    exchangeLoaded,\r\n    (tl, el) => (tl && el)\r\n)\r\n\r\n//All Orders\r\nconst allOrdersLoaded = state => get(state, 'exchange.allOrders.loaded', false)\r\nconst allOrders = state => get(state, 'exchange.allOrders.data', [])\r\n\r\n// Cancelled Orders\r\nconst cancelledOrdersLoaded = state => get(state, 'exchange.cancelledOrders.loaded', false)\r\nexport const cancelledOrdersLoadedSelector = createSelector(cancelledOrdersLoaded, loaded => loaded)\r\n\r\nconst cancelledOrders = state => get(state, 'exchange.cancelledOrders.data', [])\r\nexport const cancelledOrdersSelector = createSelector(cancelledOrders, o => o)\r\n\r\n// Filled Orders\r\nconst filledOrdersLoaded = state => get(state, 'exchange.filledOrders.loaded', false)\r\nexport const filledOrdersLoadedSelector = createSelector(filledOrdersLoaded, loaded => loaded)\r\n\r\n\r\nconst filledOrders = state => get(state, 'exchange.filledOrders.data', [])\r\nexport const filledOrdersSelector = createSelector(\r\n    filledOrders,\r\n    (orders) => {\r\n        // console.log(orders)\r\n        // Sort orders by date ascending for price comparison\r\n        orders = orders.sort((a,b) => a.timestamp - b.timestamp)\r\n       // console.log('ORDERS Timestamped', orders)\r\n        // Decorate the orders\r\n        orders = decorateFilledOrders(orders)\r\n       // console.log('ORDERS Decorated', orders)\r\n        // Sort orders by date descending for display\r\n        orders = orders.sort((a,b) => b.timestamp - a.timestamp)\r\n        return orders\r\n    }\r\n)\r\n\r\n\r\nconst decorateFilledOrders = (orders) => {\r\n    // Track previous to compare history\r\n    let previousOrder = orders[0]\r\n    return(\r\n      orders.map((order) => {\r\n          order = decorateOrder(order)\r\n          order = decorateFilledOrder(order, previousOrder)\r\n          previousOrder = order // Update the previous order once it's decorated\r\n          return order\r\n      })        \r\n    )\r\n}\r\n\r\nconst decorateOrder = (order) => {\r\n    let etherAmount\r\n    let tokenAmount\r\n    \r\n    // if tokenGive \r\n    if(order.tokenGive === ETHER_ADDRESS) {\r\n        etherAmount = order.amountGive\r\n        tokenAmount = order.amountGet       \r\n    } else {\r\n        etherAmount = order.amountGet\r\n        tokenAmount = order.amountGive \r\n    }\r\n\r\n\r\n    // Calculate token price to 5 decimal places\r\n    const precision = 100000\r\n    let tokenPrice = (etherAmount / tokenAmount)\r\n    tokenPrice = Math.round(tokenPrice * precision) / precision\r\n\r\n    // console.log(order)\r\n    return({\r\n      ...order,\r\n      etherAmount: ether(etherAmount),\r\n      tokenAmount: tokens(tokenAmount),\r\n      tokenPrice,\r\n      formattedTimestamp: moment.unix(order.timestamp).format('h:mm:ss a M/D')\r\n    })\r\n}\r\n\r\nconst decorateFilledOrder = (order, previousOrder) => {\r\n    return({\r\n        ...order,\r\n        tokenPriceClass: tokenPriceClass(order.tokenPrice, order.id, previousOrder)\r\n    })\r\n}\r\n\r\nconst tokenPriceClass = (tokenPrice, orderId, previousOrder) => {\r\n    // Show green price if only one order exists\r\n    if(previousOrder.id === orderId) {\r\n        return GREEN\r\n    }\r\n\r\n    // Show green price if order price higher than previous price\r\n    // Show red price if order price lower than previous order\r\n    if(previousOrder.tokenPrice <= tokenPrice) {\r\n        return GREEN // success\r\n    } else {\r\n        return RED // danger\r\n    }\r\n}\r\n\r\nconst openOrders = state => {\r\n    const all = allOrders(state)\r\n    const filled = filledOrders(state)\r\n    const cancelled = cancelledOrders(state)\r\n\r\n    const openOrders = reject(all, (order) => {   //lodash - reject\r\n        const orderFilled = filled.some((o) => o.id === order.id)      \r\n        const orderCancelled = cancelled.some((o) => o.id === order.id)\r\n        return(orderFilled || orderCancelled)\r\n        })\r\n    \r\n    return openOrders\r\n}\r\n\r\n\r\n\r\n// Order Book \r\n\r\nconst orderBookLoaded = state => cancelledOrdersLoaded(state) && filledOrdersLoaded(state) && allOrdersLoaded(state)\r\nexport const orderBookLoadedSelector = createSelector(orderBookLoaded, loaded => loaded)\r\n\r\n//Create the Order Book\r\nexport const orderBookSelector = createSelector(\r\n    openOrders,\r\n    (orders) => {\r\n        // Decorate orders\r\n        orders = decorateOrderBookOrders(orders)\r\n        \r\n        // Group orders by \"orderType\"\r\n        orders = groupBy(orders, 'orderType')\r\n        \r\n        // Fetch Buy orders\r\n        const buyOrders = get(orders, 'buy', [])\r\n\r\n        // Sort Buy orders by token price\r\n        orders = {\r\n            ...orders,\r\n            buyOrders: buyOrders.sort((a,b) => b.tokenPrice - a.tokenPrice)\r\n        }\r\n\r\n        // Fetch Sell orders\r\n        const sellOrders = get(orders, 'sell', [])\r\n\r\n        // Sort Sell orders by token price\r\n        orders = {\r\n            ...orders,\r\n            sellOrders: sellOrders.sort((a,b) => b.tokenPrice - a.tokenPrice)\r\n        }\r\n        return orders\r\n    }\r\n)\r\n\r\nconst decorateOrderBookOrders = (orders) => {\r\n    return(\r\n        orders.map((order) => {\r\n            order = decorateOrder(order)\r\n            order = decorateOrderBookOrder(order)\r\n            // Decorate Order book order\r\n            return(order)\r\n        })\r\n    )\r\n}\r\n\r\nconst decorateOrderBookOrder = (order) => {\r\n    const orderType = order.tokenGive === ETHER_ADDRESS ? 'buy' : 'sell'\r\n    return({\r\n        ...order,\r\n        orderType,\r\n        orderTypeClass: (orderType === 'buy' ? GREEN : RED),\r\n        orderFillClass: orderType === 'buy' ? 'sell' : 'buy'\r\n    })\r\n}\r\n\r\n\r\n// My Transactions \r\n\r\nexport const myFilledOrdersLoadedSelector = createSelector(filledOrdersLoaded, loaded => loaded)\r\n\r\nexport const myFilledOrdersSelector = createSelector(\r\n    account,\r\n    filledOrders,\r\n    (account, orders) => {\r\n        // Find our orders\r\n        orders = orders.filter((o) => o.user === account || o.userFill === account)\r\n\r\n        // Sort by date descending\r\n        orders = orders.sort((a,b) => a.timestamp - b.timestamp)\r\n\r\n        //Decorate orders - add display attributes\r\n        orders = decorateMyFilledOrders(orders, account)\r\n        return orders\r\n    }\r\n)\r\n\r\n\r\nconst decorateMyFilledOrders = (orders, account) => {\r\n    return(\r\n        orders.map((order) => {\r\n            order = decorateOrder(order)\r\n            order = decorateMyFilledOrder(order, account)\r\n            return(order)\r\n        })\r\n    )\r\n}\r\n\r\n\r\nconst decorateMyFilledOrder = (order, account) => {\r\n    const myOrder = order.user === account\r\n\r\n    let orderType \r\n    if(myOrder) {\r\n        orderType = order.tokenGive === ETHER_ADDRESS ? 'buy' : 'sell'\r\n    } else {\r\n        orderType = order.tokenGive === ETHER_ADDRESS ? 'sell' : 'buy'\r\n    }\r\n\r\n    return({\r\n        ...order,\r\n        orderType,\r\n        orderTypeClass: (orderType === 'buy' ? GREEN : RED),\r\n        orderSign: (orderType === 'buy' ? '+' : '-')\r\n    })\r\n}\r\n\r\n\r\nexport const myOpenOrdersLoadedSelector = createSelector(orderBookLoaded, loaded => loaded)\r\n\r\nexport const myOpenOrdersSelector = createSelector(\r\n    account,\r\n    openOrders,\r\n    (account, orders) => {\r\n       // console.log('ORDERS', orders)\r\n\r\n        // Filter orders create by current account\r\n        orders = orders.filter((o) => o.user === account)\r\n        // console.log('ORDERS', orders)\r\n        \r\n        // Decorate orders - add display attributes\r\n        orders = decorateMyOpenOrders(orders)\r\n\r\n        // console.log('ORDERS', orders)\r\n\r\n        //Sort orders by date descending\r\n        orders = orders.sort((a,b) => b.timestamp - a.timestamp)\r\n        // console.log('ORDERS', orders)\r\n        return orders\r\n    }\r\n)\r\n\r\n\r\nconst decorateMyOpenOrders = (orders, account) => {\r\n    return(\r\n        orders.map((order) => {\r\n            order = decorateOrder(order)\r\n            order = decorateMyOpenOrder(order, account)\r\n            return(order)\r\n        })\r\n    )\r\n}\r\n\r\n\r\nconst decorateMyOpenOrder = (order, account) => {\r\n    let orderType = order.tokenGive === ETHER_ADDRESS ? 'buy' : 'sell'\r\n    \r\n    return({\r\n        ...order,\r\n        orderType,\r\n        orderTypeClass: (orderType === 'buy' ? GREEN : RED)\r\n    })\r\n}\r\n\r\n\r\nexport const priceChartLoadedSelector = createSelector(filledOrdersLoaded, loaded => loaded)\r\n\r\nexport const priceChartSelector = createSelector(\r\n    filledOrders,\r\n    (orders) => {\r\n        // Sort orders by data ascending to compare history\r\n        orders = orders.sort((a,b) => b.timestamp - a.timestamp)\r\n        orders = orders.map((o) => decorateOrder(o))\r\n\r\n        return({\r\n            series: [{\r\n                data: buildGraphData(orders)\r\n            }]\r\n        })\r\n    }\r\n)\r\n\r\nconst buildGraphData = (orders) => {\r\n    // Group the orders by hour for the graph\r\n    orders = groupBy(orders, (o) => moment.unix(o.timestamp).startOf('hour').format())\r\n\r\n    // Get each hour where data exists\r\n    const hours = Object.keys(orders)\r\n\r\n    //Build the graph series\r\n    const graphData = hours.map((hour) => {\r\n        // Fetch all the orders from current hour\r\n        \r\n        const group = orders[hour]\r\n        // Calculate price values - open, high, low, close\r\n\r\n        const open = group[0] //first order\r\n        const high = maxBy(group, 'tokenPrice') // use lodash maxBy for high price\r\n        const low = minBy(group, 'tokenPrice') // low price (lodash minBy)\r\n        const close = group[group.length -1] // last order\r\n        \r\n        return({\r\n            x: new Date(hour),\r\n            y: [open.tokenPrice, high.tokenPrice, low.tokenPrice, close.tokenPrice]\r\n        })\r\n    })\r\n    \r\n    return graphData\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}